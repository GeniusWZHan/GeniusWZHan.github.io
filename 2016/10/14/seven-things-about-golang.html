<!DOCTYPE html>
<html lang="zh-Hans">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="kongwenqiang" />



<meta name="description" content="Go以简洁著称，但简洁中不乏值得玩味的小细节。这些小细节不如goroutine、interface和channel那样”高大上”，”屌 丝”得可能不经常被人注意到，但它们却对理解Go语言有着重要的作用。这里想挑出一些和大家一起通过详实的例子来逐一展开和理解。本文内容较为基础，适合初学者，高手可飘过:)">
<meta property="og:type" content="article">
<meta property="og:title" content="关于go你必须知道的7件事">
<meta property="og:url" content="https://leokongwq.github.io/2016/10/14/seven-things-about-golang.html">
<meta property="og:site_name" content="戒修-沉迷技术的小沙弥">
<meta property="og:description" content="Go以简洁著称，但简洁中不乏值得玩味的小细节。这些小细节不如goroutine、interface和channel那样”高大上”，”屌 丝”得可能不经常被人注意到，但它们却对理解Go语言有着重要的作用。这里想挑出一些和大家一起通过详实的例子来逐一展开和理解。本文内容较为基础，适合初学者，高手可飘过:)">
<meta property="og:updated_time" content="2016-10-14T18:09:08.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="关于go你必须知道的7件事">
<meta name="twitter:description" content="Go以简洁著称，但简洁中不乏值得玩味的小细节。这些小细节不如goroutine、interface和channel那样”高大上”，”屌 丝”得可能不经常被人注意到，但它们却对理解Go语言有着重要的作用。这里想挑出一些和大家一起通过详实的例子来逐一展开和理解。本文内容较为基础，适合初学者，高手可飘过:)">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="戒修-沉迷技术的小沙弥" type="application/atom+xml">



    <link rel="shortcut icon" href="/favicon.png">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css">



<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>关于go你必须知道的7件事 | 戒修-沉迷技术的小沙弥</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>
<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<script src="/js/search.js"></script>
<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: true
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/avatar.png" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">kongwenqiang</a></h1>
        </hgroup>

        
        <p class="header-subtitle">我喜欢GO</p>
        

        
            <form id="search-form">
            <input type="text" id="local-search-input" name="q" placeholder="search..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="false" />
            <i class="fa fa-times" onclick="resetSearch()"></i>
            </form>
            <div id="local-search-result"></div>
            <p class='no-result'>No results found <i class='fa fa-spinner fa-pulse'></i></p>
        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="mailto:leokongwq@gmail.com" title="Email"></a>
                            
                                <a class="fa GitHub" href="https://github.com/leokongwq" title="GitHub"></a>
                            
                                <a class="fa RSS" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AOP/">AOP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ActiveMQ/">ActiveMQ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ActiveQM/">ActiveQM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DDD/">DDD</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DNS/">DNS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GO/">GO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MQ/">MQ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NET/">NET</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nginx/">Nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OS/">OS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Openresy/">Openresy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/REST/">REST</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TCP/">TCP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/algo/">algo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/aop/">aop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cache/">cache</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/centos/">centos</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/computer/">computer</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/consul/">consul</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/curator/">curator</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/curl/">curl</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/devops/">devops</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/devtools/">devtools</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/">github</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/go/">go</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/golang/">golang</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gossip/">gossip</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/guava/">guava</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hadoop/">hadoop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hive/">hive</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http/">http</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java8/">java8</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jdk/">jdk</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jekyll/">jekyll</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jquery/">jquery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/json/">json</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jta/">jta</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jvm/">jvm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kafka/">kafka</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lua/">lua</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mac/">mac</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/maven/">maven</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/microservices/">microservices</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/">mongodb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mq/">mq</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/netty/">netty</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx/">nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node/">node</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nodejs/">nodejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/npm/">npm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/oauth2/">oauth2</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/openresty/">openresty</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/osx/">osx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pig/">pig</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/">redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/resin/">resin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/soa/">soa</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring/">spring</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring-mvc/">spring-mvc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/springMVC/">springMVC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/springboot/">springboot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/springcloud/">springcloud</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sqoop/">sqoop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ssh/">ssh</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tomcat/">tomcat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/uml/">uml</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vert-x/">vert.x</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vim/">vim</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/">web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web安全/">web安全</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xa/">xa</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xml/">xml</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zookeeper/">zookeeper</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/分布式/">分布式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/并发/">并发</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/微服务/">微服务</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/架构/">架构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/算法/">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/随笔/">随笔</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/面试/">面试</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="http://www.imhan.com">Hanny&#39;s Blog</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://www.chepoo.com">IT技术精华网</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">只想做个好程序员!</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">kongwenqiang</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/avatar.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">kongwenqiang</a></h1>
            </hgroup>
            
            <p class="header-subtitle">我喜欢GO</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:leokongwq@gmail.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/leokongwq" title="GitHub"></a>
                            
                                <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="标签" friends="友情链接" about="关于我"/>
</nav>
      <div class="body-wrap"><article id="post-seven-things-about-golang" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/10/14/seven-things-about-golang.html" class="article-date">
      <time datetime="2016-10-14T08:50:45.000Z" itemprop="datePublished">2016-10-14</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      关于go你必须知道的7件事
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/golang/">golang</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/go/">go</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <blockquote>
<p>Go以简洁著称，但简洁中不乏值得玩味的小细节。这些小细节不如goroutine、interface和channel那样”高大上”，”屌 丝”得可能不经常被人注意到，但它们却对理解Go语言有着重要的作用。这里想挑出一些和大家一起通过详实的例子来逐一展开和理解。本文内容较为基础，适合初学者，高手可飘过:)</p>
</blockquote>
<a id="more"></a>
<h3 id="一、源文件字符集和字符集编码"><a href="#一、源文件字符集和字符集编码" class="headerlink" title="一、源文件字符集和字符集编码"></a>一、源文件字符集和字符集编码</h3><p>Go源码文件默认采用Unicode字符集，Unicode码点(code point)<br>和内存中字节序列（byte sequence）的变换实现使用了UTF-8<br>，一种变长多字节编码，同时也是一种事实字符集编码标准，为Linux、MacOSX 上的默认字符集编码，因此使用Linux或MacOSX进行Go程序开发，你会省去很多字符集转换方面的烦恼。但如果你是在Windows上使用 默认编辑器编辑Go源码文本，当你编译以下代码时会遇到编译错误：</p>
<figure class="highlight golang"><figcaption><span>hello.go</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
</pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span>
<span class="line"></span>
<span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span>
<span class="line"></span>
<span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span>
<span class="line">    fmt.Println(<span class="string">"中国人"</span>)</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line">$ <span class="keyword">go</span> build hello.<span class="keyword">go</span></span>
<span class="line"># command-line-arguments</span>
<span class="line">hello.<span class="keyword">go</span>:<span class="number">6</span> illegal UTF<span class="number">-8</span> sequence d6 d0</span>
<span class="line">hello.<span class="keyword">go</span>:<span class="number">6</span> illegal UTF<span class="number">-8</span> sequence b9</span>
<span class="line">hello.<span class="keyword">go</span>:<span class="number">6</span> illegal UTF<span class="number">-8</span> sequence fa c8</span>
<span class="line">hello.<span class="keyword">go</span>:<span class="number">6</span> illegal UTF<span class="number">-8</span> sequence cb <span class="number">22</span></span>
<span class="line">hello.<span class="keyword">go</span>:<span class="number">6</span> newline in <span class="keyword">string</span></span>
<span class="line">hello.<span class="keyword">go</span>:<span class="number">7</span> syntax error: unexpected &#125;, expected )</span>
</pre></td></tr></table></figure>
<p>这是因为Windows默认采用的是CP936字符集编码，也就是GBK编码，“中国人”三个字的内存字节序列为：</p>
<p>“d0d6    fab9    cbc8    000a” （通过iconv转换，然后用od -x查看）</p>
<p>这个字节序列并非utf-8字节序列，Go编译器因此无法识别。要想通过编译，需要将该源文件转换为UTF-8编码格式。</p>
<p>字符集编码对字符和字符串字面值(Literal)影响最大，在Go中对于字符串我们可以有三种写法：</p>
<p><strong>1) 字面值</strong></p>
<p>var s = “中国人”</p>
<p><strong>2) 码点表示法</strong></p>
<p>var s1 = “\u4e2d\u56fd\u4eba”</p>
<p>or</p>
<p>var s2 = “\U00004e2d\U000056fd\U00004eba”</p>
<p><strong>3) 字节序列表示法（二进制表示法）</strong></p>
<p>var s3 = “\xe4\xb8\xad\xe5\x9b\xbd\xe4\xba\xba”</p>
<p>这三种表示法中，除字面值转换为字节序列存储时根据编辑器保存的源码文件编码格式之外，其他两种均不受编码格式影响。我们可以通过逐字节输出来查 看字节序列的内容：</p>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
</pre></td><td class="code"><pre><span class="line">fmt.Println(<span class="string">"s byte sequence:"</span>)</span>
<span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(s); i++ &#123;</span>
<span class="line">    fmt.Printf(<span class="string">"0x%x "</span>, s[i])</span>
<span class="line">&#125;</span>
<span class="line">fmt.Println(<span class="string">""</span>)</span>
</pre></td></tr></table></figure>
<h3 id="二、续行"><a href="#二、续行" class="headerlink" title="二、续行"></a>二、续行</h3><p>良好的代码style一般会要求代码中不能有太long的代码行，否则会影响代码阅读者的体验。在C中有续行符”\”专门用于代码续行处理；但在 Go中没有专属续行符，如何续行需要依据Go的语法规则（参见Go spec）。</p>
<p>Go与C一样，都是以分号(“;”)作为语句结束的标识。不过大多数情况下，分号无需程序员手工输入，而是由编译器自动识别语句结束位置，并插入分号。因此续行要选择合法的位置。下面代码展示了一些合法的续行位置：(别嫌太丑，这里仅仅是展示合法位置的demo)</p>
<figure class="highlight golang"><figcaption><span>details-in-go/2/newline.go </span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
<span class="line">26</span>
<span class="line">27</span>
<span class="line">28</span>
<span class="line">29</span>
<span class="line">30</span>
<span class="line">31</span>
<span class="line">32</span>
<span class="line">33</span>
<span class="line">34</span>
<span class="line">35</span>
<span class="line">36</span>
<span class="line">37</span>
<span class="line">38</span>
<span class="line">39</span>
<span class="line">40</span>
<span class="line">41</span>
<span class="line">42</span>
<span class="line">43</span>
<span class="line">44</span>
<span class="line">45</span>
</pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> (</span>
<span class="line">    s = <span class="string">"This is an example about code newline,"</span> +</span>
<span class="line">        <span class="string">"for string as right value"</span></span>
<span class="line">    d = <span class="number">5</span> + <span class="number">4</span> + <span class="number">7</span> +</span>
<span class="line">        <span class="number">4</span></span>
<span class="line">    a = [...]<span class="keyword">int</span>&#123;<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>,</span>
<span class="line">        <span class="number">8</span>&#125;</span>
<span class="line">    m = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span>,</span>
<span class="line">        <span class="number">100</span>)</span>
<span class="line">    c <span class="keyword">struct</span> &#123;</span>
<span class="line">        m1     <span class="keyword">string</span></span>
<span class="line">        m2, m3 <span class="keyword">int</span></span>
<span class="line">        m4     *<span class="keyword">float64</span></span>
<span class="line">    &#125;</span>
<span class="line"></span>
<span class="line">    f <span class="function"><span class="keyword">func</span><span class="params">(<span class="keyword">int</span>,</span>
<span class="line">        <span class="keyword">float32</span>)</span> <span class="params">(<span class="keyword">int</span>,</span>
<span class="line">        error)</span></span>
<span class="line">)</span>
<span class="line"></span>
<span class="line"><span class="title">func</span> <span class="title">foo</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">int</span>)</span> <span class="params">(<span class="keyword">string</span>, error)</span></span> &#123;</span>
<span class="line">    <span class="keyword">return</span> <span class="string">""</span>,</span>
<span class="line">        <span class="literal">nil</span></span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span>
<span class="line">    <span class="keyword">if</span> i := d; i &gt;</span>
<span class="line">        <span class="number">100</span> &#123;</span>
<span class="line">    &#125;</span>
<span class="line"></span>
<span class="line">    <span class="keyword">var</span> sum <span class="keyword">int</span></span>
<span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">100</span>; i = i +</span>
<span class="line">        <span class="number">1</span> &#123;</span>
<span class="line">        sum += i</span>
<span class="line">    &#125;</span>
<span class="line"></span>
<span class="line">    foo(<span class="number">1</span>,</span>
<span class="line">        <span class="number">6</span>)</span>
<span class="line"></span>
<span class="line">    <span class="keyword">var</span> i <span class="keyword">int</span></span>
<span class="line">    fmt.Printf(<span class="string">"%s, %d\n"</span>,</span>
<span class="line">        <span class="string">"this is a demo"</span>+</span>
<span class="line">            <span class="string">" of fmt Printf"</span>,</span>
<span class="line">        i)</span>
<span class="line">&#125;</span>
</pre></td></tr></table></figure>
<p>实际编码中，我们可能经常遇到的是fmt.Printf系列方法中format string太长的情况，但由于Go不支持相邻字符串自动连接(concatenate)，只能通过+来连接fmt字符串，且+必须放在前一行末尾。另外Gofmt工具会自动调整一些不合理的续行处理，主要针对 for, if等控制语句。</p>
<h3 id="三、Method-Set"><a href="#三、Method-Set" class="headerlink" title="三、Method Set"></a>三、Method Set</h3><p>Method Set是Go语法中一个重要的隐式概念，在为interface变量做动态类型赋值、embeding struct/interface、type alias、method expression时都会用到Method Set这个重要概念。</p>
<p><strong>1.interface的Method Set</strong></p>
<p>根据Go spec，interface类型的Method Set就是其interface（An interface type specifies a method set called its interface）。</p>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
</pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> I <span class="keyword">interface</span> &#123;</span>
<span class="line">    Method1()</span>
<span class="line">    Method2()</span>
<span class="line">&#125;</span>
</pre></td></tr></table></figure>
<p>I的Method Set包含的就是其literal中的两个方法：Method1和Method2。我们可以通过reflect来获取interface类型的 Method Set：</p>
<figure class="highlight golang"><figcaption><span>details-in-go/3/interfacemethodset.go</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
</pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span>
<span class="line"></span>
<span class="line"><span class="keyword">import</span> (</span>
<span class="line">    <span class="string">"fmt"</span></span>
<span class="line">    <span class="string">"reflect"</span></span>
<span class="line">)</span>
<span class="line"></span>
<span class="line"><span class="keyword">type</span> I <span class="keyword">interface</span> &#123;</span>
<span class="line">    Method1()</span>
<span class="line">    Method2()</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span>
<span class="line">    <span class="keyword">var</span> i *I</span>
<span class="line">    elemType := reflect.TypeOf(i).Elem()</span>
<span class="line">    n := elemType.NumMethod()</span>
<span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span>
<span class="line">        fmt.Println(elemType.Method(i).Name)</span>
<span class="line">    &#125;</span>
<span class="line">&#125;</span>
</pre></td></tr></table></figure>
<p>运行结果：</p>
<pre><code>$go run interfacemethodset.go
Method1
Method2
</code></pre><p><strong>2.除interface type外的类型的Method Set</strong></p>
<p>对于非interface type的类型T，其Method Set为所有receiver为T类型的方法组成；而类型<em>T的Method Set则包含所有receiver为T和</em>T类型的方法。</p>
<figure class="highlight golang"><figcaption><span>details-in-go/3/othertypemethodset.go</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
</pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span>
<span class="line"></span>
<span class="line"><span class="keyword">import</span> <span class="string">"./utils"</span></span>
<span class="line"></span>
<span class="line"><span class="keyword">type</span> T <span class="keyword">struct</span> &#123;</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t T)</span> <span class="title">Method1</span><span class="params">()</span></span> &#123;</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *T)</span> <span class="title">Method2</span><span class="params">()</span></span> &#123;</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *T)</span> <span class="title">Method3</span><span class="params">()</span></span> &#123;</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span>
<span class="line">    <span class="keyword">var</span> t T</span>
<span class="line">    utils.DumpMethodSet(&amp;t)</span>
<span class="line"></span>
<span class="line">    <span class="keyword">var</span> pt *T</span>
<span class="line">    utils.DumpMethodSet(&amp;pt)</span>
<span class="line">&#125;</span>
</pre></td></tr></table></figure>
<p>我们要dump出T和*T各自的Method Set，运行结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
</pre></td><td class="code"><pre><span class="line">$go run othertypemethodset.go</span>
<span class="line">main.T&apos;s method sets:</span>
<span class="line">     Method1</span>
<span class="line"></span>
<span class="line">*main.T&apos;s method sets:</span>
<span class="line">     Method1</span>
<span class="line">     Method2</span>
<span class="line">     Method3</span>
</pre></td></tr></table></figure>
<p>可以看出类型T的Method set仅包含一个receiver类型为T的方法：Method1，而<em>T的Method Set则包含了T的Method Set以及所有receiver类型为</em>T的Method。</p>
<p>如果此时我们有一个interface type如下：</p>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
</pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> I <span class="keyword">interface</span> &#123;</span>
<span class="line">    Method1()</span>
<span class="line">    Method2()</span>
<span class="line">&#125;</span>
</pre></td></tr></table></figure>
<p>那下面哪个赋值语句合法呢？合不合法完全依赖于右值类型是否实现了interface type I的所有方法，即右值类型的Method Set是否包含了I的 所有方法。</p>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
</pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> t T</span>
<span class="line"><span class="keyword">var</span> pt *T</span>
<span class="line"><span class="keyword">var</span> i I = t</span>
<span class="line">or</span>
<span class="line"><span class="keyword">var</span> i I = pt</span>
</pre></td></tr></table></figure>
<p>编译错误告诉我们：</p>
<pre><code>var i I = t 
// cannot use t (type T) as type I in assignment: T does not implement I (Method2 method has pointer receiver)
</code></pre><p>T的Method Set中只有Method1一个方法，没有实现I接口中的 Method2，因此不能用t赋值给i；而<em>T实现了I的所有接口，赋值合 法。不过Method set校验仅限于在赋值给interface变量时进行，无论是T还是</em>T类型的方法集中的方法，对于T或*T类型变量都是可见且可以调用的，如下面代码 都是合法的：</p>
<pre><code>pt.Method1()
t.Method3()
</code></pre><p>因为Go编译器会自动为你的代码做receiver转换：</p>
<pre><code>pt.Method1() &lt;=&gt; (*pt).Method1()
t.Method3() &lt;=&gt; (&amp;t).Method3()
</code></pre><p>很多人纠结于method定义时receiver的类型（T or *T），个人觉得有两点考虑：</p>
<p><strong>1) 效率</strong><br>   Go方法调用receiver是以传值的形式传入方法中的。如果类型size较大，以value形式传入消耗较大，这时指针类型就是首选。</p>
<p><strong>2) 是否赋值给interface变量、以什么形式赋值</strong><br>   就像本节所描述的，由于T和*T的Method Set可能不同，我们在设计Method receiver type时需要考虑在interface赋值时通过对Method set的校验。</p>
<p><strong>3、embeding type的Method Set</strong></p>
<p>【interface embeding】</p>
<p>我们先来看看interface类型embeding。例子如下：</p>
<figure class="highlight golang"><figcaption><span>details-in-go/3/embedinginterface.go</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
<span class="line">26</span>
<span class="line">27</span>
<span class="line">28</span>
<span class="line">29</span>
<span class="line">30</span>
<span class="line">31</span>
<span class="line">32</span>
<span class="line">33</span>
<span class="line">34</span>
<span class="line">35</span>
</pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span>
<span class="line"></span>
<span class="line"><span class="keyword">import</span> <span class="string">"./utils"</span></span>
<span class="line"></span>
<span class="line"><span class="keyword">type</span> I1 <span class="keyword">interface</span> &#123;</span>
<span class="line">    I1Method1()</span>
<span class="line">    I1Method2()</span>
<span class="line">&#125;</span>
<span class="line"><span class="keyword">type</span> I2 <span class="keyword">interface</span> &#123;</span>
<span class="line">    I2Method()</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="keyword">type</span> I3 <span class="keyword">interface</span> &#123;</span>
<span class="line">    I1</span>
<span class="line">    I2</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span>
<span class="line">    utils.DumpMethodSet((*I1)(<span class="literal">nil</span>))</span>
<span class="line">    utils.DumpMethodSet((*I2)(<span class="literal">nil</span>))</span>
<span class="line">    utils.DumpMethodSet((*I3)(<span class="literal">nil</span>))</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line">$<span class="keyword">go</span> run embedinginterface.<span class="keyword">go</span></span>
<span class="line">main.I1<span class="string">'s method sets:</span>
<span class="line">     I1Method1</span>
<span class="line">     I1Method2</span>
<span class="line"></span>
<span class="line">main.I2'</span>s method sets:</span>
<span class="line">     I2Method</span>
<span class="line"></span>
<span class="line">main.I3<span class="string">'s method sets:</span>
<span class="line">     I1Method1</span>
<span class="line">     I1Method2</span>
<span class="line">     I2Method</span></span>
</pre></td></tr></table></figure>
<p>可以看出嵌入interface type的interface type I3的Method Set包含了被嵌入的interface type：I1和I2的Method Set。很多情况下，我们Go的interface type中仅包含有少量方法，常常仅是一个Method，通过interface type embeding来定义一个新interface，这是Go的一个惯用法，比如我们常用的io包中的Reader, Writer以及ReadWriter接口：</p>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
</pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Reader <span class="keyword">interface</span> &#123;</span>
<span class="line">    Read(p []<span class="keyword">byte</span>) (n <span class="keyword">int</span>, err error)</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="keyword">type</span> Writer <span class="keyword">interface</span> &#123;</span>
<span class="line">    Write(p []<span class="keyword">byte</span>) (n <span class="keyword">int</span>, err error)</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="keyword">type</span> ReadWriter <span class="keyword">interface</span> &#123;</span>
<span class="line">    Reader</span>
<span class="line">    Writer</span>
<span class="line">&#125;</span>
</pre></td></tr></table></figure>
<p>【struct embeding interface】</p>
<p>在struct中嵌入interface type后，struct的Method Set中将包含interface的Method Set：</p>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
</pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> T <span class="keyword">struct</span> &#123;</span>
<span class="line">    I1</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(T)</span> <span class="title">Method1</span><span class="params">()</span></span> &#123;</span>
<span class="line"></span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span>
<span class="line">    … …</span>
<span class="line">    <span class="keyword">var</span> t T</span>
<span class="line">    utils.DumpMethodSet(&amp;t)</span>
<span class="line">    <span class="keyword">var</span> pt = &amp;T&#123;</span>
<span class="line">        I1: I1Impl&#123;&#125;,</span>
<span class="line">    &#125;</span>
<span class="line">    utils.DumpMethodSet(&amp;pt)</span>
<span class="line">&#125;</span>
</pre></td></tr></table></figure>
<p>输出结果与预期一致：</p>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
</pre></td><td class="code"><pre><span class="line">main.T<span class="string">'s method sets:</span>
<span class="line">     I1Method1</span>
<span class="line">     I1Method2</span>
<span class="line">     Method1</span>
<span class="line"></span>
<span class="line">*main.T'</span>s method sets:</span>
<span class="line">     I1Method1</span>
<span class="line">     I1Method2</span>
<span class="line">     Method1</span>
</pre></td></tr></table></figure>
<p>【struct embeding struct】</p>
<p>在struct中embeding struct提供了一种“继承”的手段，外部的Struct可以“继承”嵌入struct的所有方法（无论receiver是T还是*T类型）实现，但 Method Set可能会略有不同。看下面例子：</p>
<figure class="highlight plain"><figcaption><span>details-in-go/3/embedingstructinstruct.go</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
<span class="line">26</span>
<span class="line">27</span>
<span class="line">28</span>
<span class="line">29</span>
<span class="line">30</span>
<span class="line">31</span>
<span class="line">32</span>
<span class="line">33</span>
<span class="line">34</span>
<span class="line">35</span>
<span class="line">36</span>
<span class="line">37</span>
<span class="line">38</span>
<span class="line">39</span>
<span class="line">40</span>
<span class="line">41</span>
<span class="line">42</span>
<span class="line">43</span>
<span class="line">44</span>
<span class="line">45</span>
<span class="line">46</span>
<span class="line">47</span>
<span class="line">48</span>
<span class="line">49</span>
<span class="line">50</span>
<span class="line">51</span>
<span class="line">52</span>
<span class="line">53</span>
<span class="line">54</span>
<span class="line">55</span>
<span class="line">56</span>
<span class="line">57</span>
<span class="line">58</span>
<span class="line">59</span>
<span class="line">60</span>
<span class="line">61</span>
<span class="line">62</span>
<span class="line">63</span>
</pre></td><td class="code"><pre><span class="line">package main</span>
<span class="line"></span>
<span class="line">import &quot;./utils&quot;</span>
<span class="line"></span>
<span class="line">type T struct &#123;</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line">func (T) InstMethod1OfT() &#123;</span>
<span class="line"></span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line">func (T) InstMethod2OfT() &#123;</span>
<span class="line"></span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line">func (*T) PtrMethodOfT() &#123;</span>
<span class="line"></span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line">type S struct &#123;</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line">func (S) InstMethodOfS() &#123;</span>
<span class="line"></span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line">func (*S) PtrMethodOfS() &#123;</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line">type C struct &#123;</span>
<span class="line">    T</span>
<span class="line">    *S</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line">func main() &#123;</span>
<span class="line">    var c = C&#123;S: &amp;S&#123;&#125;&#125;</span>
<span class="line">    utils.DumpMethodSet(&amp;c)</span>
<span class="line">    var pc = &amp;C&#123;S: &amp;S&#123;&#125;&#125;</span>
<span class="line">    utils.DumpMethodSet(&amp;pc)</span>
<span class="line"></span>
<span class="line">    c.InstMethod1OfT()</span>
<span class="line">    c.PtrMethodOfT()</span>
<span class="line">    c.InstMethodOfS()</span>
<span class="line">    c.PtrMethodOfS()</span>
<span class="line">    pc.InstMethod1OfT()</span>
<span class="line">    pc.PtrMethodOfT()</span>
<span class="line">    pc.InstMethodOfS()</span>
<span class="line">    pc.PtrMethodOfS()</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line">$go run embedingstructinstruct.go</span>
<span class="line">main.C&apos;s method sets:</span>
<span class="line">     InstMethod1OfT</span>
<span class="line">     InstMethod2OfT</span>
<span class="line">     InstMethodOfS</span>
<span class="line">     PtrMethodOfS</span>
<span class="line"></span>
<span class="line">*main.C&apos;s method sets:</span>
<span class="line">     InstMethod1OfT</span>
<span class="line">     InstMethod2OfT</span>
<span class="line">     InstMethodOfS</span>
<span class="line">     PtrMethodOfS</span>
<span class="line">     PtrMethodOfT</span>
</pre></td></tr></table></figure>
<p>可以看出：<br>类型C的Method Set = T的Method Set + <em>S的Method Set<br>类型</em>C的Method Set = <em>T的Method Set + </em>S的Method Set</p>
<p>同时通过例子可以看出，无论是T还是<em>S的方法，C或</em>C类型变量均可调用（编译器甜头），不会被局限在Method Set中。</p>
<h3 id="4、alias-type的Method-Set"><a href="#4、alias-type的Method-Set" class="headerlink" title="4、alias type的Method Set"></a>4、alias type的Method Set</h3><p>Go支持为已有类型定义alias type，如：</p>
<pre><code>type MyInterface I
type Mystruct T
</code></pre><p>对于alias type, Method Set是如何定义的呢？我们看下面例子：</p>
<figure class="highlight golang"><figcaption><span>details-in-go/3/aliastypemethodset.go</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
<span class="line">26</span>
<span class="line">27</span>
<span class="line">28</span>
<span class="line">29</span>
<span class="line">30</span>
<span class="line">31</span>
<span class="line">32</span>
<span class="line">33</span>
<span class="line">34</span>
<span class="line">35</span>
<span class="line">36</span>
<span class="line">37</span>
<span class="line">38</span>
<span class="line">39</span>
<span class="line">40</span>
<span class="line">41</span>
<span class="line">42</span>
<span class="line">43</span>
<span class="line">44</span>
<span class="line">45</span>
<span class="line">46</span>
<span class="line">47</span>
<span class="line">48</span>
<span class="line">49</span>
<span class="line">50</span>
<span class="line">51</span>
<span class="line">52</span>
<span class="line">53</span>
<span class="line">54</span>
<span class="line">55</span>
<span class="line">56</span>
</pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span>
<span class="line"></span>
<span class="line"><span class="keyword">import</span> <span class="string">"./utils"</span></span>
<span class="line"></span>
<span class="line"><span class="keyword">type</span> I <span class="keyword">interface</span> &#123;</span>
<span class="line">    IMethod1()</span>
<span class="line">    IMethod2()</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="keyword">type</span> T <span class="keyword">struct</span> &#123;</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(T)</span> <span class="title">InstMethod</span><span class="params">()</span></span> &#123;</span>
<span class="line"></span>
<span class="line">&#125;</span>
<span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(*T)</span> <span class="title">PtrMethod</span><span class="params">()</span></span> &#123;</span>
<span class="line"></span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="keyword">type</span> MyInterface I</span>
<span class="line"><span class="keyword">type</span> MyStruct T</span>
<span class="line"></span>
<span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span>
<span class="line">    utils.DumpMethodSet((*I)(<span class="literal">nil</span>))</span>
<span class="line"></span>
<span class="line">    <span class="keyword">var</span> t T</span>
<span class="line">    utils.DumpMethodSet(&amp;t)</span>
<span class="line">    <span class="keyword">var</span> pt = &amp;T&#123;&#125;</span>
<span class="line">    utils.DumpMethodSet(&amp;pt)</span>
<span class="line"></span>
<span class="line">    utils.DumpMethodSet((*MyInterface)(<span class="literal">nil</span>))</span>
<span class="line"></span>
<span class="line">    <span class="keyword">var</span> m MyStruct</span>
<span class="line">    utils.DumpMethodSet(&amp;m)</span>
<span class="line">    <span class="keyword">var</span> pm = &amp;MyStruct&#123;&#125;</span>
<span class="line">    utils.DumpMethodSet(&amp;pm)</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line">$<span class="keyword">go</span> run aliastypemethodset.<span class="keyword">go</span></span>
<span class="line">main.I<span class="string">'s method sets:</span>
<span class="line">     IMethod1</span>
<span class="line">     IMethod2</span>
<span class="line"></span>
<span class="line">main.T'</span>s method sets:</span>
<span class="line">     InstMethod</span>
<span class="line"></span>
<span class="line">*main.T<span class="string">'s method sets:</span>
<span class="line">     InstMethod</span>
<span class="line">     PtrMethod</span>
<span class="line"></span>
<span class="line">main.MyInterface'</span>s method sets:</span>
<span class="line">     IMethod1</span>
<span class="line">     IMethod2</span>
<span class="line"></span>
<span class="line">main.MyStruct<span class="string">'s method set is empty!</span>
<span class="line">*main.MyStruct'</span>s method set is empty!</span>
</pre></td></tr></table></figure>
<p>从例子的结果上来看，Go对于interface和struct的alias type给出了“不一致”的结果：</p>
<p>MyInterface的Method Set与接口类型I Method Set一致；<br>而MyStruct并未得到T的哪怕一个Method，MyStruct的Method Set为空。</p>
<h3 id="四、Method-Type、Method-Expression、Method-Value"><a href="#四、Method-Type、Method-Expression、Method-Value" class="headerlink" title="四、Method Type、Method Expression、Method Value"></a>四、Method Type、Method Expression、Method Value</h3><p>Go中没有class，方法与对象通过receiver联系在一起，我们可以为任何非builtin类型定义method：</p>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
</pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> T <span class="keyword">struct</span> &#123;</span>
<span class="line">    a <span class="keyword">int</span></span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t T)</span> <span class="title">Get</span><span class="params">()</span> <span class="title">int</span></span>       &#123; <span class="keyword">return</span> t.a &#125;</span>
<span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *T)</span> <span class="title">Set</span><span class="params">(a <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123; t.a = a; <span class="keyword">return</span> t.a &#125;</span>
</pre></td></tr></table></figure>
<p>在C++等OO语言中，对象在调用方法时，编译器会自动在方法的第一个参数中传入this/self指针，而对于Go来 说，receiver也是同样道理，将T的method转换为普通function定义：</p>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
</pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Get</span><span class="params">(t T)</span> <span class="title">int</span></span>       &#123; <span class="keyword">return</span> t.a &#125;</span>
<span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Set</span><span class="params">(t *T, a <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123; t.a = a; <span class="keyword">return</span> t.a &#125;</span>
</pre></td></tr></table></figure>
<p>这种function形式被称为Method Type，也可以称为Method的signature。</p>
<p>Method的一般使用方式如下：</p>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
</pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> t T</span>
<span class="line">t.Get()</span>
<span class="line">t.Set(<span class="number">1</span>)</span>
</pre></td></tr></table></figure>
<p>不过我们也可以像普通function那样使用它，根据上面的Method Type定义：</p>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
</pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> t T</span>
<span class="line">T.Get(t)</span>
<span class="line">(*T).Set(&amp;t, <span class="number">1</span>)</span>
</pre></td></tr></table></figure>
<p>这种以直接以类型名T调用方法M的表达方法称为Method Expression。类型T只能调用T的Method Set中的方法；同理<em>T只能调用</em>T的Method Set中的方法。上述例子中T的Method Set中只有Get，因此T.Get是合法的。但T.Set则不合法：</p>
<pre><code>T.Set(2) //invalid method expression T.Set (needs pointer receiver: (*T).Set)
</code></pre><p>我们只能使用(*T).Set(&amp;t, 11)。</p>
<p>这样看来Method Expression有些类似于C++中的static方法(以该类的某个对象实例作为第一个参数)。</p>
<p>另外Method express自身类型就是一个普通function，可以作为右值赋值给一个函数类型的变量：</p>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
</pre></td><td class="code"><pre><span class="line">f1 := (*T).Set <span class="comment">//函数类型：func (t *T, int)int</span></span>
<span class="line">f2 := T.Get <span class="comment">//函数类型：func(t T)int</span></span>
<span class="line">f1(&amp;t, <span class="number">3</span>)</span>
<span class="line">fmt.Println(f2(t))</span>
</pre></td></tr></table></figure>
<p>Go中还定义了一种与Method有关的语法：如果一个表达式t具有静态类型T，M是T的Method Set中的一个方法，那么t.M即为Method Value。注意这里是t.M而不是T.M。</p>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
</pre></td><td class="code"><pre><span class="line">f3 := (&amp;t).Set <span class="comment">//函数类型：func(int)int</span></span>
<span class="line">f3(<span class="number">4</span>)</span>
<span class="line">f4 := t.Get<span class="comment">//函数类型：func()int   </span></span>
<span class="line">fmt.Println(f4())</span>
</pre></td></tr></table></figure>
<p>可以看出，Method value与Method Expression不同之处在于，Method value绑定了T对象实例，它的函数原型并不包含Method Expression函数原型中的第一个参数。完整例子参见：details-in-go/4/methodexpressionandmethodvalue.go。</p>
<h3 id="五、for-range“坑”大阅兵"><a href="#五、for-range“坑”大阅兵" class="headerlink" title="五、for range“坑”大阅兵"></a>五、for range“坑”大阅兵</h3><p>for range的引入提升了Go的表达能力，但for range显然不是”免费的午餐“，在享用这个美味前，需要搞清楚for range的一些坑。</p>
<p><strong>1、iteration variable重用</strong></p>
<p>for range的idiomatic的使用方式是使用short variable declaration（:=）形式在for expression中声明iteration variable，但需要注意的是这些variable在每次循环体中都会被重用，而不是重新声明。</p>
<figure class="highlight golang"><figcaption><span>details-in-go/5/iterationvariable.go</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
</pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> m = [...]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span>
<span class="line"><span class="keyword">for</span> i, v := <span class="keyword">range</span> m &#123;</span>
<span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span>
<span class="line">        time.Sleep(time.Second * <span class="number">3</span>)</span>
<span class="line">        fmt.Println(i, v)</span>
<span class="line">    &#125;()</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line">time.Sleep(time.Second * <span class="number">10</span>)</span>
</pre></td></tr></table></figure>
<p>在我的Mac上，输出结果如下：</p>
<pre><code>$go run iterationvariable.go
4 5
4 5
4 5
4 5
4 5
</code></pre><p>各个goroutine中输出的i,v值都是for range循环结束后的i, v最终值，而不是各个goroutine启动时的i, v值。一个可行的fix方法：</p>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
</pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i, v := <span class="keyword">range</span> m &#123;</span>
<span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">(i, v <span class="keyword">int</span>)</span></span> &#123;</span>
<span class="line">        time.Sleep(time.Second * <span class="number">3</span>)</span>
<span class="line">        fmt.Println(i, v)</span>
<span class="line">    &#125;(i, v)</span>
<span class="line">&#125;</span>
</pre></td></tr></table></figure>
<p><strong>2、range expression副本参与iteration</strong></p>
<p>range后面接受的表达式的类型包括：array, pointer to array, slice, string, map和channel(有读权限的)。我们以array为例来看一个简单的例子：</p>
<figure class="highlight golang"><figcaption><span>details-in-go/5/arrayrangeexpression.go</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
</pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">arrayRangeExpression</span><span class="params">()</span></span> &#123;</span>
<span class="line">    <span class="keyword">var</span> a = [<span class="number">5</span>]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span>
<span class="line">    <span class="keyword">var</span> r [<span class="number">5</span>]<span class="keyword">int</span></span>
<span class="line"></span>
<span class="line">    fmt.Println(<span class="string">"a = "</span>, a)</span>
<span class="line"></span>
<span class="line">    <span class="keyword">for</span> i, v := <span class="keyword">range</span> a &#123;</span>
<span class="line">        <span class="keyword">if</span> i == <span class="number">0</span> &#123;</span>
<span class="line">            a[<span class="number">1</span>] = <span class="number">12</span></span>
<span class="line">            a[<span class="number">2</span>] = <span class="number">13</span></span>
<span class="line">        &#125;</span>
<span class="line">        r[i] = v</span>
<span class="line">    &#125;</span>
<span class="line"></span>
<span class="line">    fmt.Println(<span class="string">"r = "</span>, r)</span>
<span class="line">&#125;</span>
</pre></td></tr></table></figure>
<p>我们期待输出结果：</p>
<pre><code>a =  [1 2 3 4 5]
r =  [1 12 13 4 5]
a =  [1 12 13 4 5]
</code></pre><p>但实际输出结果却是：</p>
<pre><code>a =  [1 2 3 4 5]
r =  [1 2 3 4 5]
a =  [1 12 13 4 5]
</code></pre><p>我们原以为在第一次iteration，也就是i = 0时，我们对a的修改(a[1] = 12，a[2] = 13)会在第二次、第三次循环中被v取出，但结果却是v取出的依旧是a被修改前的值：2和3。这就是for range的一个不大不小的坑：range expression副本参与循环。也就是说在上面这个例子里，真正参与循环的是a的副本，而不是真正的a，伪代码如 下：</p>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
</pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i, v := <span class="keyword">range</span> a<span class="string">' &#123;//a'</span> is <span class="built_in">copy</span> from a</span>
<span class="line">    <span class="keyword">if</span> i == <span class="number">0</span> &#123;</span>
<span class="line">        a[<span class="number">1</span>] = <span class="number">12</span></span>
<span class="line">        a[<span class="number">2</span>] = <span class="number">13</span></span>
<span class="line">    &#125;</span>
<span class="line">    r[i] = v</span>
<span class="line">&#125;</span>
</pre></td></tr></table></figure>
<p>Go中的数组在内部表示为连续的字节序列，虽然长度是Go数组类型的一部分，但长度并不包含的数组的内部表示中，而是由编译器在编译期计算出 来。这个例子中，对range表达式的拷贝，即对一个数组的拷贝，a’则是Go临时分配的连续字节序列，与a完全不是一块内存。因此无论a被 如何修改，其副本a’依旧保持原值，并且参与循环的是a’，因此v从a’中取出的仍旧是a的原值，而非修改后的值。</p>
<p>我们再来试试pointer to array：</p>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
</pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">pointerToArrayRangeExpression</span><span class="params">()</span></span> &#123;</span>
<span class="line">    <span class="keyword">var</span> a = [<span class="number">5</span>]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span>
<span class="line">    <span class="keyword">var</span> r [<span class="number">5</span>]<span class="keyword">int</span></span>
<span class="line"></span>
<span class="line">    fmt.Println(<span class="string">"pointerToArrayRangeExpression result:"</span>)</span>
<span class="line">    fmt.Println(<span class="string">"a = "</span>, a)</span>
<span class="line"></span>
<span class="line">    <span class="keyword">for</span> i, v := <span class="keyword">range</span> &amp;a &#123;</span>
<span class="line">        <span class="keyword">if</span> i == <span class="number">0</span> &#123;</span>
<span class="line">            a[<span class="number">1</span>] = <span class="number">12</span></span>
<span class="line">            a[<span class="number">2</span>] = <span class="number">13</span></span>
<span class="line">        &#125;</span>
<span class="line"></span>
<span class="line">        r[i] = v</span>
<span class="line">    &#125;</span>
<span class="line"></span>
<span class="line">    fmt.Println(<span class="string">"r = "</span>, r)</span>
<span class="line">    fmt.Println(<span class="string">"a = "</span>, a)</span>
<span class="line">    fmt.Println(<span class="string">""</span>)</span>
<span class="line">&#125;</span>
</pre></td></tr></table></figure>
<p>这回的输出结果如下：</p>
<pre><code>pointerToArrayRangeExpression result:
a =  [1 2 3 4 5]
r =  [1 12 13 4 5]
a =  [1 12 13 4 5]
</code></pre><p>我们看到这次r数组的值与最终a被修改后的值一致了。这个例子中我们使用了*[5]int作为range表达式，其副本依旧是一个指向原数组 a的指针，因此后续所有循环中均是&amp;a指向的原数组亲自参与的，因此v能从&amp;a指向的原数组中取出a修改后的值。</p>
<p>idiomatic go建议我们尽可能的用slice替换掉array的使用，这里用slice能否实现预期的目标呢？我们来试试：</p>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
</pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sliceRangeExpression</span><span class="params">()</span></span> &#123;</span>
<span class="line">    <span class="keyword">var</span> a = [<span class="number">5</span>]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span>
<span class="line">    <span class="keyword">var</span> r [<span class="number">5</span>]<span class="keyword">int</span></span>
<span class="line"></span>
<span class="line">    fmt.Println(<span class="string">"sliceRangeExpression result:"</span>)</span>
<span class="line">    fmt.Println(<span class="string">"a = "</span>, a)</span>
<span class="line"></span>
<span class="line">    <span class="keyword">for</span> i, v := <span class="keyword">range</span> a[:] &#123;</span>
<span class="line">        <span class="keyword">if</span> i == <span class="number">0</span> &#123;</span>
<span class="line">            a[<span class="number">1</span>] = <span class="number">12</span></span>
<span class="line">            a[<span class="number">2</span>] = <span class="number">13</span></span>
<span class="line">        &#125;</span>
<span class="line"></span>
<span class="line">        r[i] = v</span>
<span class="line">    &#125;</span>
<span class="line"></span>
<span class="line">    fmt.Println(<span class="string">"r = "</span>, r)</span>
<span class="line">    fmt.Println(<span class="string">"a = "</span>, a)</span>
<span class="line">    fmt.Println(<span class="string">""</span>)</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line">pointerToArrayRangeExpression result:</span>
<span class="line">a =  [<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span>]</span>
<span class="line">r =  [<span class="number">1</span> <span class="number">12</span> <span class="number">13</span> <span class="number">4</span> <span class="number">5</span>]</span>
<span class="line">a =  [<span class="number">1</span> <span class="number">12</span> <span class="number">13</span> <span class="number">4</span> <span class="number">5</span>]</span>
</pre></td></tr></table></figure>
<p>显然用slice也能实现预期要求。我们可以分析一下slice是如何做到的。slice在go的内部表示为一个struct，由(<em>T, len, cap)组成，其中</em>T指向slice对应的underlying array的指针，len是slice当前长度，cap为slice的最大容量。当range进行expression复制时，它实际上复制的是一个 slice，也就是那个struct。副本struct中的<em>T依旧指向原slice对应的array，为此对slice的修改都反映到 underlying array a上去了，v从副本struct中</em>T指向的underlying array中获取数组元素，也就得到了被修改后的元素值。<br>slice与array还有一个不同点，就是其len在运行时可以被改变，而array的len是一个常量，不可改变。那么len变化的 slice对for range有何影响呢？我们继续看一个例子：</p>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
</pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sliceLenChangeRangeExpression</span><span class="params">()</span></span> &#123;</span>
<span class="line">    <span class="keyword">var</span> a = []<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span>
<span class="line">    <span class="keyword">var</span> r = <span class="built_in">make</span>([]<span class="keyword">int</span>, <span class="number">0</span>)</span>
<span class="line"></span>
<span class="line">    fmt.Println(<span class="string">"sliceLenChangeRangeExpression result:"</span>)</span>
<span class="line">    fmt.Println(<span class="string">"a = "</span>, a)</span>
<span class="line"></span>
<span class="line">    <span class="keyword">for</span> i, v := <span class="keyword">range</span> a &#123;</span>
<span class="line">        <span class="keyword">if</span> i == <span class="number">0</span> &#123;</span>
<span class="line">            a = <span class="built_in">append</span>(a, <span class="number">6</span>, <span class="number">7</span>)</span>
<span class="line">        &#125;</span>
<span class="line"></span>
<span class="line">        r = <span class="built_in">append</span>(r, v)</span>
<span class="line">    &#125;</span>
<span class="line"></span>
<span class="line">    fmt.Println(<span class="string">"r = "</span>, r)</span>
<span class="line">    fmt.Println(<span class="string">"a = "</span>, a)</span>
<span class="line">&#125;</span>
</pre></td></tr></table></figure>
<p>输出结果：</p>
<pre><code>a =  [1 2 3 4 5]
r =  [1 2 3 4 5]
a =  [1 2 3 4 5 6 7]
</code></pre><p>在这个例子中，原slice a在for range过程中被附加了两个元素6和7，其len由5增加到7，但这对于r却没有产生影响。这里的原因就在于a的副本a’的内部表示struct中的 len字段并没有改变，依旧是5，因此for range只会循环5次，也就只获取a对应的underlying数组的前5个元素。<br>range的副本行为会带来一些性能上的消耗，尤其是当range expression的类型为数组时，range需要复制整个数组；而当range expression类型为pointer to array或slice时，这个消耗将小得多，仅仅需要复制一个指针或一个slice的内部表示（一个struct）即可。我们可以通过 benchmark test来看一下三种情况的消耗情况对比：<br>对于元素个数为100的int数组或slice，测试结果如下：</p>
<figure class="highlight golang"><figcaption><span>details-in-go/5/arraybenchmark</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
</pre></td><td class="code"><pre><span class="line"><span class="keyword">go</span> test -bench=.</span>
<span class="line">testing: warning: no tests to run</span>
<span class="line">PASS</span>
<span class="line">BenchmarkArrayRangeLoop<span class="number">-4</span>             <span class="number">20000000</span>           <span class="number">116</span> ns/op</span>
<span class="line">BenchmarkPointerToArrayRangeLoop<span class="number">-4</span>    <span class="number">20000000</span>            <span class="number">64.5</span> ns/op</span>
<span class="line">BenchmarkSliceRangeLoop<span class="number">-4</span>             <span class="number">20000000</span>            <span class="number">70.9</span> ns/op</span>
</pre></td></tr></table></figure>
<p>可以看到range expression类型为slice或pointer to array的性能相近，消耗都近乎是数组类型的1/2。</p>
<p><strong>3、其他range expression类型</strong></p>
<p>对于range后面的其他表达式类型，比如string, map, channel，for range依旧会制作副本。</p>
<p>【string】<br>对string来说，由于string的内部表示为struct {*byte, len)，并且string本身是immutable的，因此其行为和消耗和slice expression类似。不过for range对于string来说，每次循环的单位是rune(code point的值)，而不是byte，index为迭代字符码点的第一个字节的position：</p>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
</pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s = <span class="string">"中国人"</span></span>
<span class="line"><span class="keyword">for</span> i, v := <span class="keyword">range</span> s &#123;</span>
<span class="line">    fmt.Printf(<span class="string">"%d %s 0x%x\n"</span>, i, <span class="keyword">string</span>(v), v)</span>
<span class="line">&#125;</span>
</pre></td></tr></table></figure>
<p>输出结果：</p>
<pre><code>0 中 0x4e2d
3 国 0x56fd
6 人 0x4eba
</code></pre><p>如果s中存在非法utf8字节序列，那么v将返回0xFFFD这个特殊值，并且在接下来一轮循环中，v将仅前进一个字节：</p>
<p>//byte sequence of s: 0xe4 0xb8 0xad 0xe5 0x9b 0xbd 0xe4 0xba 0xba</p>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
</pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> sl = []<span class="keyword">byte</span>&#123;<span class="number">0xe4</span>, <span class="number">0xb8</span>, <span class="number">0xad</span>, <span class="number">0xe5</span>, <span class="number">0x9b</span>, <span class="number">0xbd</span>, <span class="number">0xe4</span>, <span class="number">0xba</span>, <span class="number">0xba</span>&#125;</span>
<span class="line"><span class="keyword">for</span> _, v := <span class="keyword">range</span> sl &#123;</span>
<span class="line">    fmt.Printf(<span class="string">"0x%x "</span>, v)</span>
<span class="line">&#125;</span>
<span class="line">fmt.Println(<span class="string">"\n"</span>)</span>
<span class="line"></span>
<span class="line">sl[<span class="number">3</span>] = <span class="number">0xd0</span></span>
<span class="line">sl[<span class="number">4</span>] = <span class="number">0xd6</span></span>
<span class="line">sl[<span class="number">5</span>] = <span class="number">0xb9</span></span>
<span class="line"></span>
<span class="line"><span class="keyword">for</span> i, v := <span class="keyword">range</span> <span class="keyword">string</span>(sl) &#123;</span>
<span class="line">    fmt.Printf(<span class="string">"%d %x\n"</span>, i, v)</span>
<span class="line">&#125;</span>
</pre></td></tr></table></figure>
<p>输出结果：</p>
<pre><code>0xe4 0xb8 0xad 0xe5 0x9b 0xbd 0xe4 0xba 0xba

0 4e2d
3 fffd
4 5b9
6 4eba
</code></pre><p>以上例子源码在details-in-go/5/stringrangeexpression.go中可以找到。</p>
<p>【map】</p>
<p>对于map来说，map内部表示为一个指针，指针副本也指向真实map，因此for range操作均操作的是源map。</p>
<p>for range不保证每次迭代的元素次序，对于下面代码：</p>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
</pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> m = <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span>&#123;</span>
<span class="line">    <span class="string">"tony"</span>: <span class="number">21</span>,</span>
<span class="line">    <span class="string">"tom"</span>:  <span class="number">22</span>,</span>
<span class="line">    <span class="string">"jim"</span>:  <span class="number">23</span>,</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="keyword">for</span> k, v := <span class="keyword">range</span> m &#123;</span>
<span class="line">    fmt.Println(k, v)</span>
<span class="line">&#125;</span>
</pre></td></tr></table></figure>
<p>输出结果可能是：</p>
<pre><code>tom 22
jim 23
tony 21
</code></pre><p>也可能是：</p>
<pre><code>tony 21
tom 22
jim 23
</code></pre><p>或其他可能。</p>
<p>如果map中的某项在循环到达前被在循环体中删除了，那么它将不会被iteration variable获取到。</p>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
</pre></td><td class="code"><pre><span class="line">counter := <span class="number">0</span></span>
<span class="line"><span class="keyword">for</span> k, v := <span class="keyword">range</span> m &#123;</span>
<span class="line">    <span class="keyword">if</span> counter == <span class="number">0</span> &#123;</span>
<span class="line">        <span class="built_in">delete</span>(m, <span class="string">"tony"</span>)</span>
<span class="line">    &#125;</span>
<span class="line">    counter++</span>
<span class="line">    fmt.Println(k, v)</span>
<span class="line">&#125;</span>
<span class="line">fmt.Println(<span class="string">"counter is "</span>, counter)</span>
</pre></td></tr></table></figure>
<p>反复运行多次，我们得到的两个结果：</p>
<pre><code>tony 21
tom 22
jim 23
counter is  3

tom 22
jim 23
counter is  2
</code></pre><p>如果在循环体中新创建一个map元素项，那该项元素可能出现在后续循环中，也可能不出现：</p>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
</pre></td><td class="code"><pre><span class="line">m[<span class="string">"tony"</span>] = <span class="number">21</span></span>
<span class="line">counter = <span class="number">0</span></span>
<span class="line"></span>
<span class="line"><span class="keyword">for</span> k, v := <span class="keyword">range</span> m &#123;</span>
<span class="line">    <span class="keyword">if</span> counter == <span class="number">0</span> &#123;</span>
<span class="line">        m[<span class="string">"lucy"</span>] = <span class="number">24</span></span>
<span class="line">    &#125;</span>
<span class="line">    counter++</span>
<span class="line">    fmt.Println(k, v)</span>
<span class="line">&#125;</span>
<span class="line">fmt.Println(<span class="string">"counter is "</span>, counter)</span>
</pre></td></tr></table></figure>
<p>执行结果：</p>
<pre><code>tony 21
tom 22
jim 23
lucy 24
counter is  4

or

tony 21
tom 22
jim 23
counter is  3
</code></pre><p>以上代码可以在details-in-go/5/maprangeexpression.go中可以找到。</p>
<p>【channel】</p>
<p>对于channel来说，channel内部表示为一个指针，channel的指针副本也指向真实channel。</p>
<p>for range最终以阻塞读的方式阻塞在channel expression上（即便是buffered channel，当channel中无数据时，for range也会阻塞在channel上），直到channel关闭：</p>
<figure class="highlight golang"><figcaption><span>details-in-go/5/channelrangeexpression.go </span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
</pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span>
<span class="line">    <span class="keyword">var</span> c = <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>)</span>
<span class="line"></span>
<span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span>
<span class="line">        time.Sleep(time.Second * <span class="number">3</span>)</span>
<span class="line">        c &lt;- <span class="number">1</span></span>
<span class="line">        c &lt;- <span class="number">2</span></span>
<span class="line">        c &lt;- <span class="number">3</span></span>
<span class="line">        <span class="built_in">close</span>(c)</span>
<span class="line">    &#125;()</span>
<span class="line"></span>
<span class="line">    <span class="keyword">for</span> v := <span class="keyword">range</span> c &#123;</span>
<span class="line">        fmt.Println(v)</span>
<span class="line">    &#125;</span>
<span class="line">&#125;</span>
</pre></td></tr></table></figure>
<p>运行结果：</p>
<pre><code>1
2
3
</code></pre><p>如果channel变量为nil，则for range将永远阻塞。</p>
<h3 id="六、select求值"><a href="#六、select求值" class="headerlink" title="六、select求值"></a>六、select求值</h3><p>golang引入的select为我们提供了一种在多个channel间实现“多路复用”的一种机制。select的运行机制这里不赘述，但select的case expression的求值顺序我们倒是要通过一个例子来了解一下：</p>
<figure class="highlight golang"><figcaption><span>details-in-go/6/select.go </span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
<span class="line">26</span>
<span class="line">27</span>
<span class="line">28</span>
<span class="line">29</span>
<span class="line">30</span>
<span class="line">31</span>
<span class="line">32</span>
<span class="line">33</span>
<span class="line">34</span>
<span class="line">35</span>
<span class="line">36</span>
<span class="line">37</span>
<span class="line">38</span>
<span class="line">39</span>
</pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">takeARecvChannel</span><span class="params">()</span> <span class="title">chan</span> <span class="title">int</span></span> &#123;</span>
<span class="line">    fmt.Println(<span class="string">"invoke takeARecvChannel"</span>)</span>
<span class="line">    c := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>)</span>
<span class="line"></span>
<span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span>
<span class="line">        time.Sleep(<span class="number">3</span> * time.Second)</span>
<span class="line">        c &lt;- <span class="number">1</span></span>
<span class="line">    &#125;()</span>
<span class="line"></span>
<span class="line">    <span class="keyword">return</span> c</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getAStorageArr</span><span class="params">()</span> *[5]<span class="title">int</span></span> &#123;</span>
<span class="line">    fmt.Println(<span class="string">"invoke getAStorageArr"</span>)</span>
<span class="line">    <span class="keyword">var</span> a [<span class="number">5</span>]<span class="keyword">int</span></span>
<span class="line">    <span class="keyword">return</span> &amp;a</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="function"><span class="keyword">func</span> <span class="title">takeASendChannel</span><span class="params">()</span> <span class="title">chan</span> <span class="title">int</span></span> &#123;</span>
<span class="line">    fmt.Println(<span class="string">"invoke takeASendChannel"</span>)</span>
<span class="line">    <span class="keyword">return</span> <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>)</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getANumToChannel</span><span class="params">()</span> <span class="title">int</span></span> &#123;</span>
<span class="line">    fmt.Println(<span class="string">"invoke getANumToChannel"</span>)</span>
<span class="line">    <span class="keyword">return</span> <span class="number">2</span></span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span>
<span class="line">    <span class="keyword">select</span> &#123;</span>
<span class="line">    <span class="comment">//recv channels</span></span>
<span class="line">    <span class="keyword">case</span> (getAStorageArr())[<span class="number">0</span>] = &lt;-takeARecvChannel():</span>
<span class="line">        fmt.Println(<span class="string">"recv something from a recv channel"</span>)</span>
<span class="line"></span>
<span class="line">        <span class="comment">//send channels</span></span>
<span class="line">    <span class="keyword">case</span> takeASendChannel() &lt;- getANumToChannel():</span>
<span class="line">        fmt.Println(<span class="string">"send something to a send channel"</span>)</span>
<span class="line">    &#125;</span>
<span class="line">&#125;</span>
</pre></td></tr></table></figure>
<p>运行结果：</p>
<pre><code>$go run select.go
invoke takeARecvChannel
invoke takeASendChannel
invoke getANumToChannel

invoke getAStorageArr
recv something from a recv channel
</code></pre><p>通过例子我们可以看出：<br>1) select执行开始时，首先所有case expression的表达式都会被求值一遍，按语法先后次序。</p>
<p>invoke takeARecvChannel<br>invoke takeASendChannel<br>invoke getANumToChannel</p>
<p>例外的是recv channel的位于赋值等号左边的表达式（这里是：(getAStorageArr())[0]）不会被求值。</p>
<p>2) 如果选择要执行的case是一个recv channel，那么它的赋值等号左边的表达式会被求值：如例子中当goroutine 3s后向recvchan写入一个int值后，select选择了recv channel执行，此时对=左侧的表达式 (getAStorageArr())[0] 开始求值，输出“invoke getAStorageArr”。</p>
<h3 id="七、panic的recover过程"><a href="#七、panic的recover过程" class="headerlink" title="七、panic的recover过程"></a>七、panic的recover过程</h3><p>Go没有提供“try-catch-finally”这样的异常处理设施，而仅仅提供了panic和recover，其中recover还要结合 defer使用。最初这也是被一些人诟病的点。但和错误码返回值一样，渐渐的大家似乎适应了这些，征讨之声渐稀，即便有也是排在“缺少generics” 之后了。</p>
<p>【panicking】</p>
<p>在没有recover的时候，一旦panic发生，panic会按既定顺序结束当前进程，这一过程成为panicking。下面的例子模拟了这一过程：</p>
<figure class="highlight golang"><figcaption><span>details-in-go/7/panicking.go</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
<span class="line">26</span>
<span class="line">27</span>
<span class="line">28</span>
<span class="line">29</span>
<span class="line">30</span>
<span class="line">31</span>
<span class="line">32</span>
</pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">foo</span><span class="params">()</span></span> &#123;</span>
<span class="line">    <span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span>
<span class="line">        fmt.Println(<span class="string">"foo defer func invoked"</span>)</span>
<span class="line">    &#125;()</span>
<span class="line">    fmt.Println(<span class="string">"foo invoked"</span>)</span>
<span class="line"></span>
<span class="line">    bar()</span>
<span class="line">    fmt.Println(<span class="string">"do something after bar in foo"</span>)</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="function"><span class="keyword">func</span> <span class="title">bar</span><span class="params">()</span></span> &#123;</span>
<span class="line">    <span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span>
<span class="line">        fmt.Println(<span class="string">"bar defer func invoked"</span>)</span>
<span class="line">    &#125;()</span>
<span class="line">    fmt.Println(<span class="string">"bar invoked"</span>)</span>
<span class="line"></span>
<span class="line">    zoo()</span>
<span class="line">    fmt.Println(<span class="string">"do something after zoo in bar"</span>)</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="function"><span class="keyword">func</span> <span class="title">zoo</span><span class="params">()</span></span> &#123;</span>
<span class="line">    <span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span>
<span class="line">        fmt.Println(<span class="string">"zoo defer func invoked"</span>)</span>
<span class="line">    &#125;()</span>
<span class="line"></span>
<span class="line">    fmt.Println(<span class="string">"zoo invoked"</span>)</span>
<span class="line">    <span class="built_in">panic</span>(<span class="string">"runtime exception"</span>)</span>
<span class="line">&#125;</span>
<span class="line"></span>
<span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span>
<span class="line">    foo()</span>
<span class="line">&#125;</span>
</pre></td></tr></table></figure>
<p>执行结果：</p>
<pre><code>$go run panicking.go
foo invoked
bar invoked
zoo invoked
zoo defer func invoked
bar defer func invoked
foo defer func invoked
panic: runtime exception

goroutine 1 [running]:
… …
exit status 2
</code></pre><p>从结果可以看出：<br>    panic在zoo中发生，在zoo真正退出前，zoo中注册的defer函数会被逐一执行(FILO)，由于zoo defer中没有捕捉panic，因此panic被抛向其caller：bar。<br>    这时对于bar而言，其函数体中的zoo的调用就好像变成了panic调用似的，zoo有些类似于“黑客帝国3”中里奥被史密斯(panic)感 染似的，也变成了史密斯(panic)。panic在bar中扩展开来，bar中的defer也没有捕捉和recover panic，因此在bar中的defer func执行完毕后，panic继续抛给bar的caller: foo；<br>    这时对于foo而言，bar就变成了panic，同理，最终foo将panic抛给了main<br>    main与上述函数一样，没有recover，直接异常返回，导致进程异常退出。</p>
<p>【recover】</p>
<p>recover只有在defer函数中调用才能起到recover的作用，这样recover就和defer函数有了紧密联系。我们在zoo的defer函数中捕捉并recover这个panic：</p>
<figure class="highlight golang"><figcaption><span>details-in-go/7/recover.go</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
</pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">zoo</span><span class="params">()</span></span> &#123;</span>
<span class="line">    <span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span>
<span class="line">        fmt.Println(<span class="string">"zoo defer func1 invoked"</span>)</span>
<span class="line">    &#125;()</span>
<span class="line"></span>
<span class="line">    <span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span>
<span class="line">        <span class="keyword">if</span> x := <span class="built_in">recover</span>(); x != <span class="literal">nil</span> &#123;</span>
<span class="line">            log.Printf(<span class="string">"recover panic: %v in zoo recover defer func"</span>, x)</span>
<span class="line">        &#125;</span>
<span class="line">    &#125;()</span>
<span class="line"></span>
<span class="line">    <span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span>
<span class="line">        fmt.Println(<span class="string">"zoo defer func2 invoked"</span>)</span>
<span class="line">    &#125;()</span>
<span class="line"></span>
<span class="line">    fmt.Println(<span class="string">"zoo invoked"</span>)</span>
<span class="line">    <span class="built_in">panic</span>(<span class="string">"zoo runtime exception"</span>)</span>
<span class="line">&#125;</span>
</pre></td></tr></table></figure>
<p>这回的执行结果如下：</p>
<pre><code>$go run recover.go
foo invoked
bar invoked
zoo invoked
zoo defer func2 invoked
2015/09/17 16:28:00 recover panic: zoo runtime exception in zoo recover defer func
zoo defer func1 invoked
do something after zoo in bar
bar defer func invoked
do something after bar in foo
foo defer func invoked
</code></pre><p>由于zoo在defer里恢复了panic，这样在zoo返回后，bar不会感知到任何异常，将按正常逻辑输出函数执行内容，比如：“do something after zoo in bar”,以此类推。</p>
<p>但若如果在zoo defer func中recover panic后，又raise another panic，那么zoo对于bar来说就又会变成panic了。</p>

      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/2016/10/14/seven-things-about-golang.html">关于go你必须知道的7件事</a></p>
        <p><span>文章作者:</span><a href="/" title="回到主页">kongwenqiang</a></p>
        <p><span>发布时间:</span>2016-10-14, 16:50:45</p>
        <p><span>最后更新:</span>2016-10-15, 02:09:08</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/2016/10/14/seven-things-about-golang.html" title="关于go你必须知道的7件事">https://leokongwq.github.io/2016/10/14/seven-things-about-golang.html</a>
            <span class="copy-path" data-clipboard-text="原文: https://leokongwq.github.io/2016/10/14/seven-things-about-golang.html　　作者: kongwenqiang" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target = "_blank">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



    <nav id="article-nav">
        
            <div id="article-nav-newer" class="article-nav-title">
                <a href="/2016/10/14/golang-error-handler.html">
                    golang错误处理
                </a>
            </div>
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2016/10/14/golang-tools-build.html">
                    go自带工具build的用法
                </a>
            </div>
        
    </nav>

  
</article>

    <div id="toc" class="toc-article">
        <strong class="toc-title">文章目录</strong>
        
            <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#一、源文件字符集和字符集编码"><span class="toc-number">1.</span> <span class="toc-text">一、源文件字符集和字符集编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#二、续行"><span class="toc-number">2.</span> <span class="toc-text">二、续行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#三、Method-Set"><span class="toc-number">3.</span> <span class="toc-text">三、Method Set</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4、alias-type的Method-Set"><span class="toc-number">4.</span> <span class="toc-text">4、alias type的Method Set</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#四、Method-Type、Method-Expression、Method-Value"><span class="toc-number">5.</span> <span class="toc-text">四、Method Type、Method Expression、Method Value</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#五、for-range“坑”大阅兵"><span class="toc-number">6.</span> <span class="toc-text">五、for range“坑”大阅兵</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#六、select求值"><span class="toc-number">7.</span> <span class="toc-text">六、select求值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#七、panic的recover过程"><span class="toc-number">8.</span> <span class="toc-text">七、panic的recover过程</span></a></li></ol>
        
    </div>
    <style>
        .left-col .switch-btn,
        .left-col .switch-area {
            display: none;
        }
        .toc-level-3 i,
        .toc-level-3 ol {
            display: none !important;
        }
    </style>

    <input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

    <script>
        yiliaConfig.toc = ["隐藏目录", "显示目录", !!"false"];
    </script>



    
<div class="share">
    
        <div class="bdsharebuttonbox">
            <a href="#" class="fa fa-twitter bds_twi" data-cmd="twi" title="分享到推特"></a>
            <a href="#" class="fa fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
            <a href="#" class="fa fa-qq bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a>
            <a href="#" class="fa fa-files-o bds_copy" data-cmd="copy" title="复制网址"></a>
            <a href="#" class="fa fa fa-envelope-o bds_mail" data-cmd="mail" title="通过邮件分享"></a>
            <a href="#" class="fa fa-weixin bds_weixin" data-cmd="weixin" title="生成文章二维码"></a>
            <a href="#" class="fa fa-share-alt bds_more" data-cmd="more"></i></a>
        </div>
        <script>
            window._bd_share_config={
                "common":{"bdSnsKey":{},"bdText":"关于go你必须知道的7件事　| 戒修-沉迷技术的小沙弥　","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js'];
        </script>
    

    
</div>







    
        <section id="comments">
    <style> aside.comment-bar { margin: auto 30px; }</style>
    <div id="disqus_thread"></div>
    <script>
        var disqus_config = function(){
            this.page.url = 'https://leokongwq.github.io/2016/10/14/seven-things-about-golang.html';
            this.page.identifier = '2016/10/14/seven-things-about-golang.html';
        };
        var loadComment = function(){
            var d = document, s = d.createElement('script');
            s.src = '//leokongwq.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        }
    </script>
    
    <script> loadComment(); </script>

</section>


    


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>




    <div class="scroll" id="post-nav-button">
        
            <a href="/2016/10/14/golang-error-handler.html" title="上一篇: golang错误处理">
                <i class="fa fa-angle-left"></i>
            </a>
        

        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2016/10/14/golang-tools-build.html" title="下一篇: go自带工具build的用法">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/07/15/how-to-process-302-in-j2ee-correctly.html">servlet如何正确处理302跳转</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/08/consul-acl.html">consul之acl配置</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/08/spring-cloud-consul.html">springcloud服务注册之consul</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/27/activemq-deleyQueue.html">ActiveMQ 延迟消息</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/17/zookeeper-curator.html">zookeeper使用之curator</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/01/distributed-system-consitency.html">分布式系统一致性总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/30/spring-RestTemplate.html">spring中RestTemplate简介</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/28/java-JVM-shutdown.html">Java 虚拟机的关机方式</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/24/zookeeper-learning-summary.html">Zookeeper简介</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/24/common-dns-records.html">常见DNS记录解释</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/22/json-web-token.html">JWT简介</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/19/activemq-redelivery-policy-config.html">ActiveMQ 消息重发策略</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/15/rest-version.html">REST API 版本化</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/15/spring-boot-deploy.html">SpringBoot应用部署模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/12/spring-rest-controller.html">基于Spring构建RESTFUL风格的controller</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/12/spring-cache.html">spring对缓存的支持及相关注解说明</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/23/computer-booting-linux.html">linux系统如何启动</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/21/computer-booting.html">计算机是如何启动的</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/06/spring-extension-point-autoconfig-summary.html">spring扩展点及springboot自动配置总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/01/kafka-send-msg-profile.html">kafka发送消息过程分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/02/28/kafka-consume-msg-profile.html">kafka 消费消息过程分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/02/12/openresy-lua-image-server.html">基于Openresy的图片服务</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/02/06/linux-file-system-schedule.html">Linux文件系统调用算法</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/31/openresty-health-check-dynamic-up-down.html">基于openresty的后端应用健康检查-动态上下线</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/30/tcp-state-transfer-diagram.html">TCP状态转化总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/27/openresty-dynamic-upstream.html">openresty动态upstream实现</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/19/distribute-lock-some-way.html">分布式锁的几种实现方式</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/19/distribute-system-consistent.html">分布式系统一致性</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/10/kotlin-coroutine-learn.html">kotlin之coroutine学习笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/10/mac-autostart.html">mac上禁止jenkins自启动</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/01/gossip-intro.html">Gossip算法介绍</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/01/consul-vs-other-software.html">consul和其它软件的比较</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/31/consul-quick-start.html">consul快速启动</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/22/computer-science-bus-arbitration.html">CPU总线仲裁</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/21/java-agent-instrumentation.html">java Instrumentation 和 Agent</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/21/activemq-monitor-hawtio.html">activemq监控之hawtio</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/20/centos-crond.html">centos下安装crond</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/16/vertx-async-callback-hell.html">vert.x异步回调地狱处理方式总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/15/vertx-Future.html">vertx-Future</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/06/vertx-cluster.html">vertx集群模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/06/microservices-gateway.html">微服务之网关</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/05/vertx-command-line-options.html">vertx命令行选项解析</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/04/vertx-web-BodyHandler.html">vert.x web开发之BodyHandler</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/02/vertx-web-global-exception.html">vertx中web全局异常处理</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/01/vertx-vertx-jdbc-client.html">vertx中vertx-jdbc-client使用问题总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/01/vertx-jdbc-datasource.html">vertx对jdbc数据源的支持</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/01/vertx-command-run.html">vert.x run 命令解析</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/30/java8-CompletableFuture-1.html">java8中CompletableFuture解析</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/22/vertx-http-server-analyze.html">vertx创建http服务器分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/22/http-content-type.html">http协议之content-type</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/22/vertx-Vertx.html">vert.x之Vertx类解析</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/21/vertx-web-route.html">vert.x web开发之route</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/21/vertx-web-router.html">vert.x web开发之router</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/18/vertx-cache.html">配置 Vert.x 缓存</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/18/vertx-Launcher.html">vertx-启动器</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/18/vertx-access-filesystem.html">vertx-访问文件系统</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/18/vertx-cluster-lock-counter.html">vertx-集群范围锁-计数器</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/18/vertx-share-data.html">vertx-共享数据</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/17/vertx-tcp.html">vertx编程tcp服务端和客户端</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/17/vertx-http.html">vertx编程http服务端和客户端</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/17/vertx-buffer.html">vertx中的buffer</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/17/vertx-json.html">vertx中的json</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/17/vertx-event-bus.html">vertx-事件总线</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/17/vertx-timer.html">vertx-执行周期性/延迟性操作</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/17/vertx-context.html">vertx-context</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/17/vertx-verticle.html">vertx-verticle介绍</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/17/vertx-quickstart.html">vert.x入门</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/10/mysql-tools-code.html">mysql常用工具SQL</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/06/maven-useful-slices.html">maven使用知识汇总</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/21/mysql-read-only-transaction.html">mysql只读事务解析</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/30/linux-clean-dns-cache.html">Linux中如何清除DNS缓存</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/28/linux-disk-raid.html">linux磁盘阵列简介</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/26/linux-centos7-rc-local.html">centos7中rc.local不起作用</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/24/understanding-maven-snapshot.html">理解maven中SNAPSHOT版本的作用</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/22/python-build-in-chapter-one.html">python内置函数-第一篇</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/22/linux-kill-parent-and-child-process.html">linux中kill主进程和所有子进程</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/21/why-enum-singleton-are-serialization-safe.html">为什么用枚举实现的单例模式可以防止反序列化？</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/19/computer-how-float-stored.html">浮点数在计算机中是如何存储的？</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/17/mysql-data-types-date-time.html">mysql数据类型-日期&时间</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/16/mysql-data-types-numeric.html">mysql数据类型-数字类型</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/15/mysql-data-types-set.html">mysql数据类型-集合</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/15/mysql-data-types-enum.html">mysql数据类型-枚举类型</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/12/mysql-data-types-string.html">mysql数据类型-字符串类型</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/11/python-multiprocessing.html">python多进程简介</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/07/python-package.html">python包机制简介</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/05/python-file-read.html">python文件读写的几种方式</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/24/python-multi-thread.html">python中的多线程</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/23/java-synchronized-detail.html">深入分析synchronized的实现原理</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/22/python-useful-codes.html">Python常用的代码</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/21/java-baised-locking.html">java中的偏向锁</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/06/mysql-deadlock-detection.html">mysql检测和处理</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/06/mysql-timeout.html">mysql中重要超时处理机制</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/22/maven-resource-plugin.html">maven-resource-plugin</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/19/java-Security-Illegal-key-size.html">java-Security-Illegal-key-size</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/19/linux-find.html">linux find使用总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/14/spring-MessageConverter.html">spring中HttpMessageConverter详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/14/mysql-transaction.html">mysql和事务</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/11/mysql-locks.html">mysql中的锁</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/09/linux-task-on-boot.html">linux开机启动任务</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/28/springboot-autoconfiguration.html">SpringBoot自动配置分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/24/mysql-batch-update-column.html">mysql批量修改列类型</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/19/mongodb-enable-query-log.html">mongodb开启查询日志</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/18/best-practices-for-a-pragmatic-restful-api.html">RESTful API 设计最佳实践</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/18/rest-introduce.html">rest架构介绍</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/17/springboot-mongo.html">springboot-mongo</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/16/idea-jvm-options.html">mac下idea虚拟机参数设置</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/12/linux-tool-traceroute.html">linux工具之traceroute</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/10/curl-learn.html">curl学习笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/28/maven-command-line-parameters.html">maven  命令行参数解释</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/08/java-enum-abstractMethod.html">java中的枚举是否可以有抽象方法</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/07/spring-ExceptionResolver.html">spring错误处理之HandlerExceptionResolver</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/07/spring-ErrorPageFilter.html">SpringBoot异常处理之ErrorPageFilter</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/05/spring-aop-MethodAnnotation.html">spring中AOP获取方法上的注解信息</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/02/spring-expandPoint.html">spring扩展点整理</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/29/maven-dependency-scope.html">maven jar包依赖范围总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/25/java-web-exception.html">java web 开发异常处理总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/18/springboot-tomcat.html">springboot发布到tomcat</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/17/mysql-date-datetime-timestamp.html">mysql中date，datetime，timestamp的区别</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/13/raft-protocol.html">raft协议简介</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/13/js-cross-domain.html">js跨域解决方案详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/28/java-netty-idleStateHandler.html">netty如何实现心跳检查</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/28/why-oauth2-use-authorization-code.html">为什么在oauth2认证中需要使用授权码</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/27/java-Executors.html">java线程池工具类Executors</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/27/mq-kafka-producer-partitioner.html">kafka发送消息分区选择策略详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/26/java-thread-dump.html">java中生成线程堆栈</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/26/java-Thread-state.html">java线程生命周期和状态</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/26/java-Thread-join.html">java中线程join方法的用法</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/26/java-ThreadPoolExecutor-RejectedExecutionHandler.html">java线程池-RejectedExecutionHandler</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/25/java-memorymapped-file-and-io.html">java中内存映射文件和IO</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/25/java-difference-between-direct-non-direct-mapped-bytebuffer-nio.html">direct, non-direct, mapped bytebuffer区别</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/25/java-difference-between-stack-and-heap.html">java中栈和堆的区别</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/25/java-how-to-create-immutable-class.html">java中如何创建不可变对象</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/25/java-interview-questions-answers-from-last-5-years.html">过去5年Java面试题精选</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/25/java-why-string-is-immutable-or-final.html">为什么在java中String是不可变或final</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/24/java-lock-and-condition-example-producer-consumer.html">java中使用锁和条件对象实现生产者-消费者模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/24/java-why-wait-notify-called-in-synchronized-block.html">为什么wait和notify必须在同步方法或同步块中调用</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/24/java-why-java-not-support-multi-inheritances.html">为何java不支持多继承</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/24/mysql-locks-intro.html">mysql锁介绍（一）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/22/java-top10-Tricky-questions.html">诡异的java面试题TOP10</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/22/java-why-wait-notify-and-notifyall-defined-in-object.html">java-为什么wait，notify和notifyall定义在Object中</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/22/java-notify-notifyall.html">java中notify和notifyall的区别</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/18/java-xml-parser.html">java中xml解析器介绍</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/09/smooth-online-offline-service.html">服务节点平滑上下线</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/07/mq-kafka-blogs.html">kafka资料汇总</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/06/mq-kafka-tutorial.html">kafka入门教程</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/06/microservice-links.html">微服务资料汇总</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/04/ddd-books.html">领域驱动设计书单</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/23/jms-message-order.html">jms-如何保证消息的顺序</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/22/golang-param-pass-value-or-point.html">值传递, 指针传递 这是一个问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/21/golang-how-to-write-go-code.html">如何开发GO代码</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/20/algo-BigData-summary.html">大数据处理总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/20/algo-HashSearch.html">algo-HashSearch</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/20/algo-BlockSearch.html">分块查找</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/20/algo-BinaryTreeSearch.html">二叉排序树查找</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/20/algo-BinarySearch.html">二分查找</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/20/SearchAlgo.html">查找算法总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/19/algo-HeapSort.html">堆排序</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/19/algo-QuickSort.html">快速排序</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/19/algo-InsertionSort.html">插入排序</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/19/algo-mergesort.html">归并排序</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/19/algo-bucketsort.html">桶排序</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/19/algo-bubblesort.html">冒泡排序</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/17/java8-CompletableFuture.html">java8中CompletableFuture详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/17/java-zookeeper-curator.html">zookeeper客户端之curator</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/16/Java-PriorityQueue.html">Java优先级队列PriorityQueue</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/13/java-LockSupport.html">java-LockSupport详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/12/mq-rocketmq-cluster.html">rocketmq集群搭建</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/12/mq-rocketmq-quickstart.html">rocketmq快速入门</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/12/linux-zero-copy.html">linux零拷贝原理（一）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/11/java-jdk9-new-features.html">java-jdk9-new-features</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/10/java-Experienced-Developer-Teach-You-Five-Things.html">经验丰富的Java开发者教给你的五件事</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/10/mq-pages.html">MQ资料汇总</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/10/DTP-best-practice.html">分布式事务典型处理方式</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/09/spring-xa-transactions-using.html">使用spring处理分布式事务</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/09/mysql-text-defaultValue.html">mysql-text-defaultValue</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/03/transaction-understanding-jta.html">深入理解JTA事务处理</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/03/transaction-jta-deeplearning.html">JTA 深度历险 - 原理与实现</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/03/transaction-management-under-j2ee.html">J2EE事务管理详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/02/java-design-pattern-summary.html">java-design_pattern-summary</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/02/spring-DTP-patterns.html">spring处理分布式事务（使用或不使用XA）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/01/mysql-master-slave-thinking.html">mysql-master-slave-thinking</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/31/java-magic-finally.html">java魔法之finally</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/31/java-magic-0xCAFEBABE.html">java魔法之0xCAFEBABE</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/31/java-magic-java-dot-net-dot-url.html">java魔法之java.net.Url</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/31/java-magic-unsafe.html">java魔法之unsafe</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/31/java-AtomicLong.html">java中原子变量之AtomicLong</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/30/distribute-transaction-manage.html">分布式系统的事务处理</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/30/the-pattern-updateCache.html">缓存更新的套路</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/29/java8-lambda.html">java8 lambda表达式详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/28/spring-annotation-value.html">spring中注解@Value解密</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/28/spring-PropertyPlaceholderConfigurer.html">spring扩展点之PropertyPlaceholderConfigurer</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/28/mac-install-python-mysql.html">mac上安装Python-Mysql</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/27/mysql-mofidy-charset.html">mysql修改表-字段-库的字符集</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/25/java8-stream.html">java8-stream</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/23/java8-optional.html">java8-optional</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/23/java-8-features-tutorial.html">java-8-features-tutorial</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/06/java-DesignPatterns-flyweight.html">java-设计模式之-享元模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/05/java-Design-Patterns-builder.html">java-设计模式之-建造者模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/03/java-DesignPatterns-proxy.html">java-设计模式之-代理模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/01/java-DesignPatterns-adapter.html">java-设计模式之-适配器模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/01/java-DesignPatterns-facade.html">java-设计模式之-外观模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/01/golang-execute-file-path.html">java-设计模式之-外观模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/01/java-DesignPatterns-bridge.html">java-设计模式之-桥接模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/28/java-DesignPatterns-command.html">java-设计模式之-命令模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/26/java-DesignPatterns-abstractFactory.html">java-设计模式之-抽象工厂模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/26/java-DesignPatterns-factoryMethod.html">java-设计模式之-工程方法模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/25/java-DesignPatterns-simpleFactory.html">java-设计模式之-简单工程模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/25/java-DesignPatterns-decorator.html">java-设计模式之-装饰者模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/25/nginx-cache.html">nginx缓存功能介绍</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/25/java-DesignPatterns-observer.html">java设计模式之-观察者模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/23/nginx-rewrite.html">nginx配置rewrite指令详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/23/java-singleton.html">java实现单例模式的几种方式</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/23/java-DesignPatterns-Singleton.html">设计模式之-单例模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/23/java-DesignPatterns-UML.html">设计模式之-UML类图快速入门</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/23/java-DesignPatterns-Strategy.html">设计模式之-策略模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/22/java-HashMap-MaxmumEntries.html">java中HashMap的最大容量解析</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/18/algo-stack-calculateExp.html">用栈实现后缀表达式的计算</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/16/algo-prime-number.html">素数相关</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/16/algo-gcd.html">求两个整数的最大公约数</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/15/java-HowThreadLocalWork.html">ThreadLocal正解</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/15/java-Reference.html">java Reference 详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/15/SpringMVC-annotationDriven.html">mvc:annotation-driver</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/11/golang-effective-go.html">golang-effective-go</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/10/openresty-lua-nginx-module.html">openresty-lua-nginx-module</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/09/linux-max-fd.html">linux中最大文件描述符数</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/09/the-difference-between-301-and-302.html">HTTP301和302的区别</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/08/nodejs-heapdump.html">nodejs调试工具之heapdump简介</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/08/nodejs-gc.html">Node.js 调试 GC 以及内存暴涨的分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/07/nodejs-debug.html">NodeJS的代码调试和性能调优</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/07/siege-introduce.html">压测工具siege简介</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/06/binary-search-tree.html">二叉查找树</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/03/full-print-BinaryTree.html">full-print-BinaryTree</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/02/best-10-practice-from-linkedin.html">LinkedIn关于提高Node.JS服务的10个建议</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/02/distributed-id-generation.html">5分钟了解分布式ID生成方案</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/27/java-LinkedList.html">java-LinkedList实现解析</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/26/java-LinkedHashMap.html">java-LinkedHashMap知识点汇总</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/26/java-HashMap.html">java-HashMap知识点汇总</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/26/japanese-50-yin.html">日语50音图学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/25/linux-netcat.html">Linux Netcat 命令用法简介</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/24/linux-backlog-maxconn.html">linux网络编程backlog和somaxconn</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/21/npm-11-useful-tips.html">npm11个提供工作效率的用法</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/20/linux-network-io.html">Linux IO模式及 select、poll、epoll详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/20/linux-io-epoll.html">Linux下的I/O复用与epoll详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/20/mac-osx-kernel.html">mac-osx-kernel</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/20/java-real-data-type-size.html">Java中数据类型真实的内存占用</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/19/vim-fileencoding.html">vim-文件编码</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/17/nodejs-exports-and-module-expots.html">nodejs中exports和module.expots异同</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/17/nodejs-module-os.html">nodejs模块-os模块</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/17/nodejs-module-path.html">nodejs模块path简介</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/17/Fibers-and-Threads-in-node.html">Fibers-and-Threads-in-node</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/17/nodejs-module-querystring.html">nodejs模块之querystring</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/17/nodejs-module-Readline.html">nodejs模块之readline</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/17/jquery-selector.html">jquery选择器详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/17/pm2-readme.html">pm2使用简介</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/17/fastjson-use.html">fastjson使用简介</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/17/character-set.html">字符集详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/17/linux-hostname.html">linux命令hostname详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/17/linux-delete-file-not-free-the-space.html">linux删除文件但磁盘空间不释放</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/17/nodeJs-module-async.html">nodeJs解决异步回调方案之module-async</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/17/redis-sentinel.html">redis哨兵功能简介</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/17/http-cache.html">http缓存详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/16/golang-import.html">golang中import语句详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/16/java-thread-profile.html">java线程必备知识</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/16/nodejs-globals.html">Nodejs全局对象</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/16/golang-flag.html">golang命令行参数解析</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/16/golang-file.html">golang文件操作</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/16/golang-userinfo.html">golang 用户信息获取</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/16/golang-time.html">golang时间操作</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/16/java-BlockingQueue.html">Java的BlockingQueue详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/16/java-runnable-callable-future.html">Java中的Runnable、Callable、Future、FutureTask的区别与示例</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/15/java-Queue.html">java队列Queue接口详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/15/strace-learn.html">手把手教你用Strace诊断问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/15/too-many-open-files.html">too-many-open-files</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/15/linux-strace.html">linux工具-strace</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/15/http-tranfer-encoding.html">HTTP 协议中的 Transfer-Encoding</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/15/lombook.html">lombook工具包简介</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/15/golang-file-size.html">golang编译后文件编写的技巧</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/15/golang-cross-compile.html">golang交叉编译</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/15/golang-performance-optimize-string.html">Go性能优化技巧-string</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/15/golang-performance-optimize-array.html">Go性能优化技巧-array</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/15/golang-performance-optimize-map.html">Go性能优化技巧-map</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/15/golang-defer.html">golang之defer简介</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/15/golang-chan.html">golang之chan简介</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/15/golang-build-version.html">golang自动生成版本信息</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/15/how-to-get-goroutine-id.html">如何获取goroutine的id</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/14/fifty-common-Mistakes-for-New-Golang-Devs.html">50个go新手开发常见的错误</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/14/ten-best-practise-for-java-exception.html">java异常处理最佳实践</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/14/golang-error-handler.html">golang错误处理</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/14/seven-things-about-golang.html">关于go你必须知道的7件事</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/14/golang-tools-build.html">go自带工具build的用法</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/14/golang-gdb-debug.html">golang程序GDB调试</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/14/hexo-post-asset-folder-html.html">hexo使用post_asset_folder功能文章链接不能以html结尾</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/14/hexo-codeblock-multiblank.html">hexo代码块前后空白行问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/13/java-serialization-deepknow.html">java-serialization-deepknow</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/13/golang-unsafe.html">golang的unsafe包简介</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/13/IDCardNo-algo.html">身份证号验证算法</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/13/byte-order.html">网络字节序</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/13/golang-testing.html">golang代码测试</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/13/linux-tool-dig.html">linux-tool-dig</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/13/golang-md5.html">golang计算字符串MD5</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/13/golang-time-format.html">golang时间格式化</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/13/golang-open-browser.html">golang打开系统浏览器</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/12/mq-compare.html">常见MQ产品比较</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/12/golang-user-define-json-UnmarshalJSON.html">golang进行json数据的解析</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/12/find-join-point-ofTwoIntersectList.html">查找无环单链表的相交节点</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/12/isIntersectWithLoop.html">单链表-链表有环如何判断相交</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/12/find-the-join-point-in-list.html">找出单链表有环的入口节点</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/12/list-hasCircle.html">判断单链表是否有环</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/12/find-mid-post-in-list.html">找出单链表的中间节点</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/12/find-the-kth-node-in-list.html">找出单链表倒数第K个节点</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/12/reverse-one-direction-list.html">单链表逆转</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/12/delete-listNode-in-O1.html">O(1)时间内删除链表节点</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/12/reverse-print-list.html">单链表的逆序打印</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/12/merge-two-sorted-list.html">合并两个升序的单向链表</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/12/print-NxN-matrix.html">打印NxN矩阵的对角线</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/12/service-discovery.html">服务发现介绍</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/12/web-reply-attack.html">web重放攻击介绍和防御方法</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/12/process-exception-in-web-dev.html">web开发异常统一处理</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/12/maven-test.html">maven-surefire-plugin简介</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/12/spring-aop-pointcut-expression.html">spring aop 切点表达式介绍</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/12/avoid-NullPointException-Java.html">java程序避免NullPointException最佳实践</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/11/jvm-codecache.html">JVM-codecache内存区域介绍</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/07/13/logstash-input-file.html">logstash-input-file</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/07/12/when-to-use-hadoop-toolbox.html">Hadoop-Hbase-Hive-Pig关系</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/06/14/JVM-Tools.html">有用的JVM工具简介</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/06/12/IllegalMonitorStateException.html">诡异的异常IllegalMonitorStateException</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/06/11/HowMysqlLoadDataWorks.html">mysql load data infile 简介</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/06/10/why-not-use-finalize.html">为什么不使用finalize</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/05/14/mac-sshd.html">mac-sshd</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/04/22/theDayEndOfJd.html">朝林最后一天</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/04/22/java-Guava-Joiner.html">Guava-Joiner</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/04/22/java-Guava-Splitor.html">Guava-Spilitor</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/04/17/howJekyllWorks.html">How Jekyll works</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/04/17/springMVCOutlines.html">Spring MVC HandlerMapping HandlerAdapter</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/04/16/JVMGcAlgorithm.html">JVM垃圾收集算法</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/04/16/JVMOptimize.html">JVM常用参数和调优</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/04/16/githubblog.html">Jekyll 快速入门</a></li></ul>




    <script>
        
    </script>

</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2016-2018 kongwenqiang
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="本站到访数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="本页阅读量"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

    <script>
        var originTitle = document.title;
        var titleTime;
        document.addEventListener("visibilitychange", function() {
            if (document.hidden) {
                document.title = "(つェ⊂) 我藏好了哦~ " + originTitle;
                clearTimeout(titleTime);
            }
            else {
                document.title = "(*´∇｀*) 被你发现啦~ " + originTitle;
                titleTime = setTimeout(function() {
                    document.title = originTitle;
                }, 2000);
            }
        })
    </script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

<script>
    var inputArea = document.querySelector("#local-search-input");
    var getSearchFile = function(){
        var path = "/search.xml";
        alert(11111);
        searchFunc(path, 'local-search-input', 'local-search-result');
    }
    inputArea.onfocus = function(){
      getSearchFile()
    }

    var $resetButton = $("#search-form .fa-times");

    var $resultArea = $("#local-search-result");
    inputArea.oninput = function(){ $resetButton.show(); }

    resetSearch = function(){
        $resultArea.html("");
        document.querySelector("#search-form").reset();
        $resetButton.hide();
        $(".no-result").hide();
    }

    inputArea.onkeydown = function(){
        if(event.keyCode==13) {
          return false
        }
    }

    $resultArea.bind("DOMNodeRemoved DOMNodeInserted", function(e) {
        if (!$(e.target).text()) {
            $(".no-result").show(200);
        } else {
          $(".no-result").hide();
        }
    })

</script>

  </div>
</body>
</html>